<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App de Salut</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      font-size: 18px; /* més gran */
    }
    .screen {
      display: none;
      padding: 20px;
    }
    .active {
      display: block;
    }
    h2 {
      margin-top: 0;
    }
    input, button, select {
      font-size: 18px;
      padding: 10px;
      margin: 8px 0;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 6px;
    }
    button:hover {
      background: #0056b3;
    }
    .task-section {
      background: white;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <!-- Pantalla Login -->
  <div id="screen-login" class="screen active">
    <h2>Inicia sessió</h2>
    <input type="email" id="login-email" placeholder="Correu electrònic">
    <input type="password" id="login-password" placeholder="Contrasenya">
    <button id="login-btn">Iniciar sessió</button>
    <button id="register-btn">Registrar-se</button>
  </div>

  <!-- Pantalla Idioma -->
  <div id="screen-idioma" class="screen">
    <h2>Escull l’idioma</h2>
    <select id="idioma">
      <option value="ca">Català</option>
      <option value="es">Castellà</option>
      <option value="en">Anglès</option>
    </select>
    <button id="idioma-continue">Continuar</button>
  </div>

  <!-- Pantalla Tasques -->
  <div id="screen-tasques" class="screen">
    <h2>Tasques del dia</h2>

    <div class="task-section">
      <h3>Medicacions</h3>
      <ul id="medicacions-list">
        <li>Paracetamol 1g – Matí</li>
        <li>Ibuprofèn 600mg – Vespre</li>
      </ul>
    </div>

    <div class="task-section">
      <h3>Cures</h3>
      <ul id="cures-list">
        <li>Canviar bena cada 12h</li>
      </ul>
    </div>

    <div class="task-section">
      <h3>Cites mèdiques</h3>
      <ul id="cites-list">
        <li>Visita cardiologia – 12/10/2025</li>
      </ul>
    </div>

    <div class="task-section">
      <h3>Condicions / Malalties</h3>
      <ul id="condicions-list">
        <li>Hipertensió</li>
        <li>Diabetis</li>
      </ul>
    </div>
  </div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { 
      getAuth, 
      signInWithEmailAndPassword, 
      createUserWithEmailAndPassword, 
      onAuthStateChanged, 
      setPersistence, 
      browserLocalPersistence 
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { 
      getFirestore, 
      setDoc, 
      doc 
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // Configura el teu Firebase
    const firebaseConfig = {
      apiKey: "EL_TEU_API_KEY",
      authDomain: "EL_TEU_PROJECTE.firebaseapp.com",
      projectId: "EL_TEU_PROJECTE",
      storageBucket: "EL_TEU_PROJECTE.appspot.com",
      messagingSenderId: "EL_TEU_ID",
      appId: "EL_TEU_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Persistència total
    setPersistence(auth, browserLocalPersistence);

    // Canvi de pantalla
    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // Login
    document.getElementById('login-btn').addEventListener('click', async () => {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (error) {
        alert("Error: " + error.message);
      }
    });

    // Registre
    document.getElementById('register-btn').addEventListener('click', async () => {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      try {
        await createUserWithEmailAndPassword(auth, email, password);
      } catch (error) {
        alert("Error: " + error.message);
      }
    });

    // Continuar idioma
    document.getElementById('idioma-continue').addEventListener('click', async () => {
      const idioma = document.getElementById('idioma').value;
      const user = auth.currentUser;
      if (user) {
        await setDoc(doc(db, "users", user.uid), { idioma }, { merge: true });
        showScreen('screen-tasques');
      }
    });

    // Quan l'usuari ja està loguejat
    onAuthStateChanged(auth, (user) => {
      if (user) {
        showScreen('screen-idioma');
      } else {
        showScreen('screen-login');
      }
    });

  </script>
</body>
</html>
